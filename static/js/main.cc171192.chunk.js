(this["webpackJsonplib-collection"]=this["webpackJsonplib-collection"]||[]).push([[0],{43:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},72:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(13),o=n.n(s),c=(n(43),n(11)),i=n(12),l=n(9),u=n(6),p=n.n(u),b=(n(45),n(76)),d=n(79),h=n(77),j=n(78),f=n(80),x=n(74),O=n(75),m=(n(46),n(5));var v=function(e){e.icon;var t=e.placeholder,n=e.inputText,r=e.inputTextChange,a=e.onEnter,s=e.onClear;return Object(m.jsx)("div",{className:"c-input-box",children:Object(m.jsx)(f.a.Group,{controlId:"formInputBox",children:Object(m.jsxs)(x.a,{children:[Object(m.jsx)(x.a.Prepend,{children:Object(m.jsx)(O.a,{variant:"link",onClick:function(){return s()},children:Object(m.jsx)("i",{className:"bi bi-x-lg",style:{color:"red",fontSize:"2rem"}})})}),Object(m.jsx)(f.a.Control,{type:"text",placeholder:t,value:n,onChange:function(e){return r(e.target.value)},onKeyPress:function(e){return"Enter"===e.key&&e.target.value.length>0?a(e.target.value):null}}),Object(m.jsx)(x.a.Append,{children:Object(m.jsx)(O.a,{variant:"link",onClick:function(e){return a(e.target.value)},children:Object(m.jsx)("i",{className:"bi bi-filetype-xlsx",style:{color:"black",fontSize:"2rem"}})})})]})})})},g=n(32),y=n.n(g),k="https://cors-proxy-alma.herokuapp.com/almaws/v1/bibs/",w="/bibs?",N="?view=full&expand=None",I={COLLECTIONS:"collections/",REPRESENTATIONS:"/representations",NONE:""};function S(){return(S=Object(c.a)(p.a.mark((function e(t,n,r,a){var s,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t==I.COLLECTIONS?k+t+n+w+"offset="+r+"&limit="+a:t==I.REPRESENTATIONS?k+n+t:k+n+N,e.prev=1,e.next=4,y.a.get(s);case 4:return o=e.sent,e.abrupt("return",{response:o,error:null});case 8:return e.prev=8,e.t0=e.catch(1),console.error("Error while geting collection with id= "+n,e.t0),e.abrupt("return",{response:null,error:e.t0});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}var C={getDataById:function(e,t,n,r){return S.apply(this,arguments)},types:I},T=n(33),_=n(34),E=function(){function e(t,n,r,a,s,o){Object(T.a)(this,e),this.mmsid=t,this.title=n,this.callNumber=r,this.totalBibs=a,this.repId=s,this.repUrl=o}return Object(_.a)(e,[{key:"setCallNumber",value:function(e){this.callNumber=e}},{key:"setTotalBibs",value:function(e){this.totalBibs=e}},{key:"setRepId",value:function(e){this.repId=e}},{key:"setRepUrl",value:function(e){this.repUrl=e}}]),e}(),L=n(19);var R=function(){var e=Object(r.useState)(!1),t=Object(l.a)(e,2),n=t[0],a=t[1],s=Object(r.useState)(""),o=Object(l.a)(s,2),u=o[0],f=o[1],x=Object(r.useState)([]),O=Object(l.a)(x,2),g=O[0],y=O[1],k=Object(r.useState)(!1),w=Object(l.a)(k,2),N=w[0],I=w[1],S=Object(r.useState)("\u05d0\u05d9\u05e8\u05e2\u05d4 \u05e9\u05d2\u05d9\u05d0\u05d4"),T=Object(l.a)(S,2),_=T[0],R=T[1],B=Object(r.useState)(!1),P=Object(l.a)(B,2),D=P[0],M=P[1],U=Object(r.useState)(0),F=Object(l.a)(U,2),A=F[0],W=F[1],V=Object(r.useState)(0),z=Object(l.a)(V,2),H=(z[0],z[1]),J=100;function G(e,t,n){console.log("This should happen only once!!!"),g.sort((function(e,t){var n=e.callNumber.toUpperCase(),r=t.callNumber.toUpperCase();return n<r?-1:n>r?1:0}));var r=(new DOMParser).parseFromString(function(){for(var e='html dir="rtl" lang="he-IL" class="no-js no-svg">\n    <head>\n        <meta charset="UTF-8" />\n    </head>\n    <body>\n        <table id="tbl_exporttable_to_xls">\n            <th>\u05db\u05d5\u05ea\u05e8</th>\n            <th>\u05db\u05d5\u05ea\u05e8 \u05de\u05ea\u05d5\u05e7\u05df</th>\n            <th>\u05d4\u05e2\u05e8\u05d5\u05ea</th>\n            <th>\u05e7\u05d9\u05e9\u05d5\u05e8</th>\n            <th>MMS ID</th>\n            <th>\u05de\u05e1\u05e4\u05e8 \u05de\u05d9\u05d5\u05df</th>\n            <tbody>',t=0;t<g.length;t++)e+="<tr><td>"+g[t].title+"</td><td></td><td></td><td><a href="+g[t].repUrl+">"+g[t].repId+"</a></td><td>"+g[t].mmsid+"</td><td>"+g[t].callNumber+"</td></tr>";return e+"</tbody>\n            </table>\n        </body>\n    </html>"}(),"text/html").getElementById("tbl_exporttable_to_xls"),a=L.a.table_to_book(r,{Workbook:{Views:[{RTL:!0}]},sheet:"sheet1",raw:!0});return a.Workbook?a.Workbook.Views[0].RTL=!0:(a.Workbook={},a.Workbook.Views=[{RTL:!0}]),a.Sheets.sheet1["!cols"].push({width:Math.max.apply(Math,Object(i.a)(g.map((function(e){return e.title.length}))))},{width:20},{width:20},{width:20},{width:20},{width:Math.max.apply(Math,Object(i.a)(g.map((function(e){return e.callNumber.length}))))}),H(100),n?L.b(a,{bookType:e,bookSST:!0,type:"base64"}):L.c(a,t||u+"."+(e||"xlsx"))}function K(){return(K=Object(c.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:G("xlsx"),M(!0);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){for(var t,n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("datafield"),r=0;r<n.length;r++)if("098"==n[r].getAttribute("tag")){t=n[r].childNodes[0]?n[r].childNodes[0].innerHTML:void 0;break}return t}function Q(){return Q=Object(c.a)(p.a.mark((function e(t){var n,r,s,o,l,b,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y([]),W(0),I(!1),M(!1),a(!0),e.next=7,C.getDataById(C.types.COLLECTIONS,u,0,J);case 7:if(n=e.sent,a(!1),!n.error){e.next=13;break}I(!0),e.next=39;break;case 13:if(!n.response){e.next=39;break}if(!(n.response.data.total_record_count>0)){e.next=37;break}if(H(10),r=n.response.data.bib,s=[],o=r.map((function(e){return new E(e.mms_id,e.title)})),s=[].concat(Object(i.a)(s),Object(i.a)(o)),W(n.response.data.total_record_count),!(n.response.data.bib.length<n.response.data.total_record_count)){e.next=28;break}for(l=n.response.data.total_record_count%100==0?parseInt(n.response.data.total_record_count/100):parseInt(n.response.data.total_record_count/100)+1,b=[],d=1;d<l;++d)b.push(100*d);return a(!0),e.next=28,Promise.all(b.map(function(){var e=Object(c.a)(p.a.mark((function e(t){var n,r,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getDataById(C.types.COLLECTIONS,u,t,J);case 2:(n=e.sent).error?I(!0):n.response&&(r=n.response.data.bib,o=r.map((function(e){return new E(e.mms_id,e.title)})),s=[].concat(Object(i.a)(s),Object(i.a)(o)),H(30),a(!1));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 28:return a(!0),e.next=31,Promise.all(s.map(function(){var e=Object(c.a)(p.a.mark((function e(t){var n,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getDataById(C.types.NONE,t.mmsid);case 2:(n=e.sent).error?I(!0):n.response&&(r=n.response.data.anies[0],a=q(r),t.setCallNumber(a.replace(/ /g,"")),H(60));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 31:return e.next=33,Promise.all(s.map(function(){var e=Object(c.a)(p.a.mark((function e(t){var n,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getDataById(C.types.REPRESENTATIONS,t.mmsid);case 2:(n=e.sent).error?I(!0):n.response&&(n.response.data.total_record_count>0?(r=n.response.data.representation[0]?n.response.data.representation[0].id:void 0,a=n.response.data.representation[0].delivery_url,r||console.log("undefine!!!!"),t.setRepId(r),t.setRepUrl(a)):(t.setRepId("\u05d0\u05d9\u05df \u05ea\u05de\u05d5\u05e0\u05d4"),t.setRepUrl("")),H(90));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 33:y(s),a(!1),e.next=39;break;case 37:I(!0),R("\u05d0\u05d9\u05df \u05e8\u05e9\u05d5\u05de\u05d5\u05ea \u05d1\u05d0\u05d5\u05e1\u05e3 \u05d6\u05d4");case 39:case"end":return e.stop()}}),e)}))),Q.apply(this,arguments)}return Object(r.useEffect)((function(){g.length>0&&g.length==A&&function(e){K.apply(this,arguments)}()}),[g]),Object(m.jsx)("div",{className:"App",children:Object(m.jsxs)(b.a,{fluid:!0,children:[Object(m.jsxs)("div",{children:[N&&Object(m.jsx)(d.a,{variant:"danger",onClose:function(){return I(!1)},children:_}),D&&Object(m.jsx)(d.a,{variant:"success",onClose:function(){return M(!1)},children:"\u05d4\u05e7\u05d5\u05d1\u05e5 \u05de\u05d5\u05db\u05df \u05dc\u05d4\u05d5\u05e8\u05d3\u05d4"})]}),Object(m.jsx)("img",{src:"https://haifa-primo.hosted.exlibrisgroup.com/primo-explore/custom/HAU/img/library-logo.png",alt:"\u05e1\u05e4\u05e8\u05d9\u05d9\u05ea \u05d9\u05d5\u05e0\u05e1 \u05d5\u05e1\u05d5\u05e8\u05d0\u05d9\u05d4 \u05e0\u05d6\u05e8\u05d9\u05d0\u05df"}),Object(m.jsx)("div",{style:{margin:"20px"},children:Object(m.jsx)("h2",{children:"\u05e8\u05e9\u05d5\u05de\u05d5\u05ea \u05d1\u05d9\u05d1\u05dc\u05d9\u05d5\u05d2\u05e8\u05e4\u05d9\u05d5\u05ea \u05dc\u05e4\u05d9 \u05de\u05e1\u05e4\u05e8 \u05d0\u05d5\u05e1\u05e3"})}),Object(m.jsx)(h.a,{id:"collection-sub-title",children:Object(m.jsx)("h4",{children:":(collectionID \u05d9\u05e9 \u05dc\u05d4\u05d6\u05d9\u05df) \u05d4\u05d5\u05e8\u05d3\u05ea \u05e7\u05d5\u05d1\u05e5 \u05d0\u05e7\u05e1\u05dc \u05e9\u05dc \u05e8\u05e9\u05d5\u05de\u05d5\u05ea \u05d1\u05d9\u05d1\u05dc\u05d9\u05d5\u05d2\u05e8\u05e4\u05d9\u05d5\u05ea \u05d5\u05e7\u05d9\u05e9\u05d5\u05e8\u05d9\u05dd \u05dc\u05d0\u05d5\u05d1\u05d9\u05d9\u05e7\u05d8\u05d9\u05dd \u05d4\u05d3\u05d9\u05d2\u05d9\u05d8\u05dc\u05d9\u05d9\u05dd \u05e9\u05d1\u05d4\u05df, \u05e2\u05dc \u05e4\u05d9 \u05de\u05e1\u05e4\u05e8 \u05d0\u05d5\u05e1\u05e3 \u05d1\u05e2\u05dc\u05de\u05d0"})}),Object(m.jsx)(h.a,{id:"rowForInput",children:Object(m.jsx)(v,{icon:Object(m.jsx)("i",{className:"bi bi-collection-fill"}),placeholder:"\u05de\u05e1\u05e4\u05e8 \u05d0\u05d5\u05e1\u05e3 (Collection ID)",onEnter:function(e){return Q.apply(this,arguments)},inputText:u,inputTextChange:function(e){return f(e)},onClear:function(){console.log("clear pressed!!!"),W(0),f(""),y([]),R(""),I(!1),M(!1)}})}),Object(m.jsx)("div",{className:"p-bib-cards",children:n&&Object(m.jsx)("div",{className:"p-subject-spinner",children:Object(m.jsx)(j.a,{animation:"border",variant:"primary"})})})]})})},B=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,81)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),s(e),o(e)}))};n(69),n(70),n(71);o.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(R,{})}),document.getElementById("root")),B()}},[[72,1,2]]]);
//# sourceMappingURL=main.cc171192.chunk.js.map