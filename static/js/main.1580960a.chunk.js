(this["webpackJsonplib-collection"]=this["webpackJsonplib-collection"]||[]).push([[0],{43:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},72:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(12),c=n.n(s),o=(n(43),n(14)),i=n(11),l=n(9),u=n(6),p=n.n(u),d=(n(45),n(76)),b=n(79),h=n(77),j=n(78),f=n(80),x=n(74),O=n(75),m=(n(46),n(5));var v=function(e){e.icon;var t=e.placeholder,n=e.inputText,r=e.inputTextChange,a=e.onEnter,s=e.onClear;return Object(m.jsx)("div",{className:"c-input-box",children:Object(m.jsx)(f.a.Group,{controlId:"formInputBox",children:Object(m.jsxs)(x.a,{children:[Object(m.jsx)(x.a.Prepend,{children:Object(m.jsx)(O.a,{variant:"link",onClick:function(){return s()},children:Object(m.jsx)("i",{className:"bi bi-x-lg",style:{color:"red",fontSize:"2rem"}})})}),Object(m.jsx)(f.a.Control,{type:"text",placeholder:t,value:n,onChange:function(e){return r(e.target.value)},onKeyPress:function(e){return"Enter"===e.key&&e.target.value.length>0?a(e.target.value):null}}),Object(m.jsx)(x.a.Append,{children:Object(m.jsx)(O.a,{variant:"link",onClick:function(e){return a(e.target.value)},children:Object(m.jsx)("i",{className:"bi bi-filetype-xlsx",style:{color:"black",fontSize:"2rem"}})})})]})})})},g=n(32),y=n.n(g),N="https://cors-proxy-alma.herokuapp.com/almaws/v1/bibs/",I="/bibs?",k="?view=full&expand=None",S={COLLECTIONS:"collections/",REPRESENTATIONS:"/representations",NONE:""};function C(){return(C=Object(i.a)(p.a.mark((function e(t,n,r,a){var s,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t==S.COLLECTIONS?N+t+n+I+"offset="+r+"&limit="+a:t==S.REPRESENTATIONS?N+n+t:N+n+k,e.prev=1,e.next=4,y.a.get(s);case 4:return c=e.sent,e.abrupt("return",{response:c,error:null});case 8:return e.prev=8,e.t0=e.catch(1),console.error("Error while geting collection with id= "+n,e.t0),e.abrupt("return",{response:null,error:e.t0});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}var _={getDataById:function(e,t,n,r){return C.apply(this,arguments)},types:S},w=n(33),E=n(34),T=function(){function e(t,n,r,a,s,c){Object(w.a)(this,e),this.mmsid=t,this.title=n,this.callNumber=r,this.totalBibs=a,this.repId=s,this.repUrl=c}return Object(E.a)(e,[{key:"setCallNumber",value:function(e){this.callNumber=e}},{key:"setTotalBibs",value:function(e){this.totalBibs=e}},{key:"setRepId",value:function(e){this.repId=e}},{key:"setRepUrl",value:function(e){this.repUrl=e}}]),e}(),B=n(19);var L=function(){var e=Object(r.useState)(!1),t=Object(l.a)(e,2),n=t[0],a=t[1],s=Object(r.useState)(""),c=Object(l.a)(s,2),u=c[0],f=c[1],x=Object(r.useState)([]),O=Object(l.a)(x,2),g=O[0],y=O[1],N=Object(r.useState)(!1),I=Object(l.a)(N,2),k=I[0],S=I[1],C=Object(r.useState)("\u05d0\u05d9\u05e8\u05e2\u05d4 \u05e9\u05d2\u05d9\u05d0\u05d4"),w=Object(l.a)(C,2),E=w[0],L=w[1],P=Object(r.useState)(!1),R=Object(l.a)(P,2),D=R[0],U=R[1],F=Object(r.useState)(0),A=Object(l.a)(F,2),M=A[0],z=A[1],H=Object(r.useState)(0),J=Object(l.a)(H,2),G=(J[0],J[1]),K=100;function q(e,t,n){console.log("This should happen only once!!!"),g.sort((function(e,t){var n=e.callNumber.toUpperCase(),r=t.callNumber.toUpperCase();return n<r?-1:n>r?1:0}));var r=(new DOMParser).parseFromString(function(){for(var e='html dir="rtl" lang="he-IL" class="no-js no-svg">\n    <head>\n        <meta charset="UTF-8" />\n    </head>\n    <body>\n        <table id="tbl_exporttable_to_xls">\n            <th>MMS ID</th>\n            <th>\u05db\u05d5\u05ea\u05e8</th>\n            <th>\u05de\u05e1\u05e4\u05e8 \u05de\u05d9\u05d5\u05df</th>\n            <th>\u05e7\u05d9\u05e9\u05d5\u05e8</th>\n            <th>\u05db\u05d5\u05ea\u05e8 \u05de\u05ea\u05d5\u05e7\u05df</th>\n            <th>\u05d4\u05e2\u05e8\u05d5\u05ea</th>\n            <tbody>',t=0;t<g.length;t++)e+="<tr><td>"+g[t].mmsid+"</td><td>"+g[t].title+"</td><td>"+g[t].callNumber+"</td><td><a href="+g[t].repUrl+">"+g[t].repId+"</a></td><td></td><td></td></tr>";return e+"</tbody>\n            </table>\n        </body>\n    </html>"}(),"text/html").getElementById("tbl_exporttable_to_xls"),a=B.a.table_to_book(r,{sheet:"sheet1",raw:!0});return G(100),n?B.b(a,{bookType:e,bookSST:!0,type:"base64"}):B.c(a,t||u+"."+(e||"xlsx"))}function Q(){return(Q=Object(i.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:q("xlsx"),U(!0);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){for(var t,n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("datafield"),r=0;r<n.length;r++)if("098"==n[r].getAttribute("tag")){t=n[r].childNodes[0]?n[r].childNodes[0].innerHTML:void 0;break}return t}function W(){return W=Object(i.a)(p.a.mark((function e(t){var n,r,s,c,l,d,b;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y([]),z(0),S(!1),U(!1),a(!0),e.next=7,_.getDataById(_.types.COLLECTIONS,u,0,K);case 7:if(n=e.sent,a(!1),!n.error){e.next=13;break}S(!0),e.next=39;break;case 13:if(!n.response){e.next=39;break}if(!(n.response.data.total_record_count>0)){e.next=37;break}if(G(10),r=n.response.data.bib,s=[],c=r.map((function(e){return new T(e.mms_id,e.title)})),s=[].concat(Object(o.a)(s),Object(o.a)(c)),z(n.response.data.total_record_count),!(n.response.data.bib.length<n.response.data.total_record_count)){e.next=28;break}for(l=n.response.data.total_record_count%100==0?parseInt(n.response.data.total_record_count/100):parseInt(n.response.data.total_record_count/100)+1,d=[],b=1;b<l;++b)d.push(100*b);return a(!0),e.next=28,Promise.all(d.map(function(){var e=Object(i.a)(p.a.mark((function e(t){var n,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.getDataById(_.types.COLLECTIONS,u,t,K);case 2:(n=e.sent).error?S(!0):n.response&&(r=n.response.data.bib,c=r.map((function(e){return new T(e.mms_id,e.title)})),s=[].concat(Object(o.a)(s),Object(o.a)(c)),G(30),a(!1));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 28:return a(!0),e.next=31,Promise.all(s.map(function(){var e=Object(i.a)(p.a.mark((function e(t){var n,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.getDataById(_.types.NONE,t.mmsid);case 2:(n=e.sent).error?S(!0):n.response&&(r=n.response.data.anies[0],a=V(r),t.setCallNumber(a.replace(/ /g,"")),G(60));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 31:return e.next=33,Promise.all(s.map(function(){var e=Object(i.a)(p.a.mark((function e(t){var n,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.getDataById(_.types.REPRESENTATIONS,t.mmsid);case 2:(n=e.sent).error?S(!0):n.response&&(n.response.data.total_record_count>0?(r=n.response.data.representation[0]?n.response.data.representation[0].id:void 0,a=n.response.data.representation[0].delivery_url,r||console.log("undefine!!!!"),t.setRepId(r),t.setRepUrl(a)):(t.setRepId("\u05d0\u05d9\u05df \u05ea\u05de\u05d5\u05e0\u05d4"),t.setRepUrl("")),G(90));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 33:y(s),a(!1),e.next=39;break;case 37:S(!0),L("\u05d0\u05d9\u05df \u05e8\u05e9\u05d5\u05de\u05d5\u05ea \u05d1\u05d0\u05d5\u05e1\u05e3 \u05d6\u05d4");case 39:case"end":return e.stop()}}),e)}))),W.apply(this,arguments)}return Object(r.useEffect)((function(){g.length>0&&g.length==M&&function(e){Q.apply(this,arguments)}()}),[g]),Object(m.jsx)("div",{className:"App",children:Object(m.jsxs)(d.a,{fluid:!0,children:[Object(m.jsxs)("div",{children:[k&&Object(m.jsx)(b.a,{variant:"danger",onClose:function(){return S(!1)},children:E}),D&&Object(m.jsx)(b.a,{variant:"success",onClose:function(){return U(!1)},children:"\u05d4\u05e7\u05d5\u05d1\u05e5 \u05de\u05d5\u05db\u05df \u05dc\u05d4\u05d5\u05e8\u05d3\u05d4"})]}),Object(m.jsx)("img",{src:"https://haifa-primo.hosted.exlibrisgroup.com/primo-explore/custom/HAU/img/library-logo.png",alt:"\u05e1\u05e4\u05e8\u05d9\u05d9\u05ea \u05d9\u05d5\u05e0\u05e1 \u05d5\u05e1\u05d5\u05e8\u05d0\u05d9\u05d4 \u05e0\u05d6\u05e8\u05d9\u05d0\u05df"}),Object(m.jsx)("div",{style:{margin:"20px"},children:Object(m.jsx)("h2",{children:"\u05e8\u05e9\u05d5\u05de\u05d5\u05ea \u05d1\u05d9\u05d1\u05dc\u05d9\u05d5\u05d2\u05e8\u05e4\u05d9\u05d5\u05ea \u05dc\u05e4\u05d9 \u05de\u05e1\u05e4\u05e8 \u05d0\u05d5\u05e1\u05e3"})}),Object(m.jsx)(h.a,{id:"collection-sub-title",children:Object(m.jsx)("h4",{children:":(collectionID \u05d9\u05e9 \u05dc\u05d4\u05d6\u05d9\u05df) \u05d4\u05d5\u05e8\u05d3\u05ea \u05e7\u05d5\u05d1\u05e5 \u05d0\u05e7\u05e1\u05dc \u05e9\u05dc \u05e8\u05e9\u05d5\u05de\u05d5\u05ea \u05d1\u05d9\u05d1\u05dc\u05d9\u05d5\u05d2\u05e8\u05e4\u05d9\u05d5\u05ea \u05d5\u05e7\u05d9\u05e9\u05d5\u05e8\u05d9\u05dd \u05dc\u05d0\u05d5\u05d1\u05d9\u05d9\u05e7\u05d8\u05d9\u05dd \u05d4\u05d3\u05d9\u05d2\u05d9\u05d8\u05dc\u05d9\u05d9\u05dd \u05e9\u05d1\u05d4\u05df, \u05e2\u05dc \u05e4\u05d9 \u05de\u05e1\u05e4\u05e8 \u05d0\u05d5\u05e1\u05e3 \u05d1\u05e2\u05dc\u05de\u05d0"})}),Object(m.jsx)(h.a,{id:"rowForInput",children:Object(m.jsx)(v,{icon:Object(m.jsx)("i",{className:"bi bi-collection-fill"}),placeholder:"\u05de\u05e1\u05e4\u05e8 \u05d0\u05d5\u05e1\u05e3 (Collection ID)",onEnter:function(e){return W.apply(this,arguments)},inputText:u,inputTextChange:function(e){return f(e)},onClear:function(){console.log("clear pressed!!!"),z(0),f(""),y([]),L(""),S(!1),U(!1)}})}),Object(m.jsx)("div",{className:"p-bib-cards",children:n&&Object(m.jsx)("div",{className:"p-subject-spinner",children:Object(m.jsx)(j.a,{animation:"border",variant:"primary"})})})]})})},P=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,81)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),s(e),c(e)}))};n(69),n(70),n(71);c.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(L,{})}),document.getElementById("root")),P()}},[[72,1,2]]]);
//# sourceMappingURL=main.1580960a.chunk.js.map