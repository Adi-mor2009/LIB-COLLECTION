(this["webpackJsonplib-collection"]=this["webpackJsonplib-collection"]||[]).push([[0],{329:function(e,t,n){},331:function(e,t,n){},332:function(e,t,n){},354:function(e,t,n){},477:function(e,t){},481:function(e,t){},483:function(e,t){},493:function(e,t){},495:function(e,t){},520:function(e,t){},522:function(e,t){},523:function(e,t){},528:function(e,t){},530:function(e,t){},549:function(e,t){},561:function(e,t){},564:function(e,t){},572:function(e,t){},590:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(80),c=n.n(o),s=(n(329),n(61)),i=n(45),l=n(27),u=n(12),p=n.n(u),d=(n(331),n(596)),b=n(598),h=n(597),f=n(599),j=n(594),x=n(595),m=(n(332),n(9));var O=function(e){e.icon;var t=e.placeholder,n=e.inputText,r=e.inputTextChange,a=e.onEnter,o=e.onClear;return Object(m.jsx)("div",{className:"c-input-box",children:Object(m.jsx)(f.a.Group,{controlId:"formInputBox",children:Object(m.jsxs)(j.a,{children:[Object(m.jsx)(j.a.Prepend,{children:Object(m.jsx)(x.a,{variant:"link",onClick:function(){return o()},children:Object(m.jsx)("i",{className:"bi bi-x-lg",style:{color:"red",fontSize:"2rem"}})})}),Object(m.jsx)(f.a.Control,{type:"text",placeholder:t,value:n,onChange:function(e){return r(e.target.value)},onKeyPress:function(e){return"Enter"===e.key&&e.target.value.length>0?a(e.target.value):null}}),Object(m.jsx)(j.a.Append,{children:Object(m.jsx)(x.a,{variant:"link",onClick:function(e){return a(e.target.value)},children:Object(m.jsx)("i",{className:"bi bi-filetype-xlsx",style:{color:"black",fontSize:"2rem"}})})})]})})})},g=n(305),v=n.n(g),y="https://cors-proxy-alma.herokuapp.com/almaws/v1/bibs/",N="/bibs?",I="?view=full&expand=None",k={COLLECTIONS:"collections/",REPRESENTATIONS:"/representations",NONE:""};function S(){return(S=Object(i.a)(p.a.mark((function e(t,n,r,a){var o,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t==k.COLLECTIONS?y+t+n+N+"offset="+r+"&limit="+a:t==k.REPRESENTATIONS?y+n+t:y+n+I,e.prev=1,e.next=4,v.a.get(o);case 4:return c=e.sent,e.abrupt("return",{response:c,error:null});case 8:return e.prev=8,e.t0=e.catch(1),console.error("Error while geting collection with id= "+n,e.t0),e.abrupt("return",{response:null,error:e.t0});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}var C={getDataById:function(e,t,n,r){return S.apply(this,arguments)},types:k},_=n(119),w=n(120),E=function(){function e(t,n,r,a,o,c){Object(_.a)(this,e),this.mmsid=t,this.title=n,this.callNumber=r,this.totalBibs=a,this.repId=o,this.repUrl=c}return Object(w.a)(e,[{key:"setCallNumber",value:function(e){this.callNumber=e}},{key:"setTotalBibs",value:function(e){this.totalBibs=e}},{key:"setRepId",value:function(e){this.repId=e}},{key:"setRepUrl",value:function(e){this.repUrl=e}}]),e}();n(602),n(600);n(601),n(354);n(355),n(586);var T=n(129);var B=function(){var e=Object(r.useState)(!1),t=Object(l.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(""),c=Object(l.a)(o,2),u=c[0],f=c[1],j=Object(r.useState)([]),x=Object(l.a)(j,2),g=x[0],v=x[1],y=Object(r.useState)(!1),N=Object(l.a)(y,2),I=N[0],k=N[1],S=Object(r.useState)("\u05d0\u05d9\u05e8\u05e2\u05d4 \u05e9\u05d2\u05d9\u05d0\u05d4"),_=Object(l.a)(S,2),w=_[0],B=_[1],L=Object(r.useState)(!1),D=Object(l.a)(L,2),P=D[0],R=D[1],U=Object(r.useState)(0),A=Object(l.a)(U,2),F=A[0],M=A[1],z=Object(r.useState)(0),H=Object(l.a)(z,2),J=(H[0],H[1]),G=100;function K(){for(var e='html dir="rtl" lang="he-IL" class="no-js no-svg">\n    <head>\n        <meta charset="UTF-8" />\n    </head>\n    <body>\n        <table id="tbl_exporttable_to_xls">\n            <th>MMS ID</th>\n            <th>\u05db\u05d5\u05ea\u05e8</th>\n            <th>\u05de\u05e1\u05e4\u05e8 \u05de\u05d9\u05d5\u05df</th>\n            <th>\u05e7\u05d9\u05e9\u05d5\u05e8</th>\n            <th>\u05db\u05d5\u05ea\u05e8 \u05de\u05ea\u05d5\u05e7\u05df</th>\n            <th>\u05d4\u05e2\u05e8\u05d5\u05ea</th>\n            <tbody>',t=0;t<g.length;t++)e+="<tr><td>"+g[t].mmsid+"</td><td>"+g[t].title+"</td><td>"+g[t].callNumber+"</td><td><a href="+g[t].repUrl+">"+g[t].repId+"</a></td><td></td><td></td></tr>";return e+="</tbody>\n            </table>\n        </body>\n    </html>"}function q(e,t,n){console.log("This should happen only once!!!"),g.sort((function(e,t){var n=e.callNumber.toUpperCase(),r=t.callNumber.toUpperCase();return n<r?-1:n>r?1:0}));var r=(new DOMParser).parseFromString(K(),"text/html").getElementById("tbl_exporttable_to_xls"),a=T.a.table_to_book(r,{sheet:"sheet1",raw:!0});return J(100),n?T.b(a,{bookType:e,bookSST:!0,type:"base64"}):T.c(a,t||u+"."+(e||"xlsx"))}function Q(){return(Q=Object(i.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("downloadDocx"),console.log(K()),q("xlsx"),R(!0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){for(var t,n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("datafield"),r=0;r<n.length;r++)if("098"==n[r].getAttribute("tag")){t=n[r].childNodes[0]?n[r].childNodes[0].innerHTML:void 0;break}return t}function W(){return W=Object(i.a)(p.a.mark((function e(t){var n,r,o,c,l,d,b;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("!!!!handleInputEnter"),v([]),M(0),a(!0),e.next=6,C.getDataById(C.types.COLLECTIONS,u,0,G);case 6:if(n=e.sent,a(!1),!n.error){e.next=12;break}k(!0),e.next=39;break;case 12:if(!n.response){e.next=39;break}if(!(n.response.data.total_record_count>0)){e.next=37;break}if(J(10),r=n.response.data.bib,o=[],c=r.map((function(e){return new E(e.mms_id,e.title)})),o=[].concat(Object(s.a)(o),Object(s.a)(c)),M(n.response.data.total_record_count),!(n.response.data.bib.length<n.response.data.total_record_count)){e.next=28;break}for(l=n.response.data.total_record_count%100==0?parseInt(n.response.data.total_record_count/100):parseInt(n.response.data.total_record_count/100)+1,console.log("index is "+l),d=[],b=1;b<l;++b)d.push(100*b);return a(!0),e.next=28,Promise.all(d.map(function(){var e=Object(i.a)(p.a.mark((function e(t){var n,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getDataById(C.types.COLLECTIONS,u,t,G);case 2:(n=e.sent).error?k(!0):n.response&&(r=n.response.data.bib,c=r.map((function(e){return new E(e.mms_id,e.title)})),o=[].concat(Object(s.a)(o),Object(s.a)(c)),J(30),a(!1));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 28:return a(!0),e.next=31,Promise.all(o.map(function(){var e=Object(i.a)(p.a.mark((function e(t){var n,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getDataById(C.types.NONE,t.mmsid);case 2:(n=e.sent).error?k(!0):n.response&&(r=n.response.data.anies[0],a=V(r),t.setCallNumber(a.replace(/ /g,"")),J(60));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 31:return e.next=33,Promise.all(o.map(function(){var e=Object(i.a)(p.a.mark((function e(t){var n,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getDataById(C.types.REPRESENTATIONS,t.mmsid);case 2:(n=e.sent).error?k(!0):n.response&&(n.response.data.total_record_count>0?(r=n.response.data.representation[0]?n.response.data.representation[0].id:void 0,a=n.response.data.representation[0].delivery_url,r||console.log("undefine!!!!"),t.setRepId(r),t.setRepUrl(a)):(t.setRepId("\u05d0\u05d9\u05df \u05ea\u05de\u05d5\u05e0\u05d4"),t.setRepUrl("")),J(90));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 33:v(o),a(!1),e.next=39;break;case 37:k(!0),B("\u05d0\u05d9\u05df \u05e8\u05e9\u05d5\u05de\u05d5\u05ea \u05d1\u05d0\u05d5\u05e1\u05e3 \u05d6\u05d4");case 39:case"end":return e.stop()}}),e)}))),W.apply(this,arguments)}return Object(r.useEffect)((function(){g.length>0&&g.length==F&&function(e){Q.apply(this,arguments)}()}),[g]),Object(m.jsx)("div",{className:"App",children:Object(m.jsxs)(d.a,{children:[Object(m.jsxs)("div",{children:[I&&Object(m.jsx)(b.a,{variant:"danger",onClose:function(){return k(!1)},children:w}),P&&Object(m.jsx)(b.a,{variant:"success",onClose:function(){return R(!1)},children:"\u05d4\u05e7\u05d5\u05d1\u05e5 \u05de\u05d5\u05db\u05df \u05dc\u05d4\u05d5\u05e8\u05d3\u05d4"})]}),Object(m.jsx)("img",{src:"https://haifa-primo.hosted.exlibrisgroup.com/primo-explore/custom/HAU/img/library-logo.png",alt:"\u05e1\u05e4\u05e8\u05d9\u05d9\u05ea \u05d9\u05d5\u05e0\u05e1 \u05d5\u05e1\u05d5\u05e8\u05d0\u05d9\u05d4 \u05e0\u05d6\u05e8\u05d9\u05d0\u05df"}),Object(m.jsxs)("div",{style:{margin:"20px"},children:[Object(m.jsx)("h2",{children:"\u05e8\u05e9\u05d5\u05de\u05d5\u05ea \u05d1\u05d9\u05d1\u05dc\u05d9\u05d5\u05d2\u05e8\u05e4\u05d9\u05d5\u05ea \u05dc\u05e4\u05d9 \u05de\u05e1\u05e4\u05e8 \u05d0\u05d5\u05e1\u05e3"}),Object(m.jsx)("h4",{style:{marginLeft:"auto !important",paddingTop:"30px"},children:":(collectionID \u05d9\u05e9 \u05dc\u05d4\u05d6\u05d9\u05df) \u05d4\u05d5\u05e8\u05d3\u05ea \u05e7\u05d5\u05d1\u05e5 \u05d0\u05e7\u05e1\u05dc \u05e9\u05dc \u05e8\u05e9\u05d5\u05de\u05d5\u05ea \u05d1\u05d9\u05d1\u05dc\u05d9\u05d5\u05d2\u05e8\u05e4\u05d9\u05d5\u05ea \u05d5\u05e7\u05d9\u05e9\u05d5\u05e8\u05d9\u05dd \u05dc\u05d0\u05d5\u05d1\u05d9\u05d9\u05e7\u05d8\u05d9\u05dd \u05d4\u05d3\u05d9\u05d2\u05d9\u05d8\u05dc\u05d9\u05d9\u05dd \u05e9\u05d1\u05d4\u05df, \u05e2\u05dc \u05e4\u05d9 \u05de\u05e1\u05e4\u05e8 \u05d0\u05d5\u05e1\u05e3 \u05d1\u05e2\u05dc\u05de\u05d0"})]}),Object(m.jsx)(O,{icon:Object(m.jsx)("i",{className:"bi bi-collection-fill"}),placeholder:"\u05db\u05d0\u05df \u05d9\u05e9 \u05dc\u05d4\u05db\u05e0\u05d9\u05e1 \u05de\u05e1\u05e4\u05e8 \u05d0\u05d5\u05e1\u05e3 (Collection ID) \u05dc\u05d7\u05d9\u05e4\u05d5\u05e9 ...",onEnter:function(e){return W.apply(this,arguments)},inputText:u,inputTextChange:function(e){return f(e)},onClear:function(){console.log("clear pressed!!!"),M(0),f(""),v([]),B(""),k(!1),R(!1)}}),Object(m.jsx)("div",{className:"p-bib-cards",children:n&&Object(m.jsx)("div",{className:"p-subject-spinner",children:Object(m.jsx)(h.a,{animation:"border",variant:"primary"})})})]})})},L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,603)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),o(e),c(e)}))};n(587),n(588),n(589);c.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(B,{})}),document.getElementById("root")),L()}},[[590,1,2]]]);
//# sourceMappingURL=main.7b615256.chunk.js.map