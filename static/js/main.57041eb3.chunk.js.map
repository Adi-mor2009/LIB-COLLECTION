{"version":3,"sources":["components/InputBox/InputBox.js","utils/ApiDataService.js","model/BibModel.js","App.js","reportWebVitals.js","index.js"],"names":["InputBox","icon","placeholder","inputText","inputTextChange","onEnter","onClear","className","Form","Group","controlId","InputGroup","Prepend","Button","variant","onClick","style","color","fontSize","Control","type","value","onChange","e","target","onKeyPress","key","length","Append","SERVER_URL","SERVER_URL_AFTER_ID_COLLECTION","SERVER_URL_AFTER_ID_BIB","types","COLLECTIONS","REPRESENTATIONS","NONE","id","pageNum","pageSize","a","getURL","axios","get","res","response","error","console","getDataById","BibModel","mms_id","title","call_number","totalBibs","rep_id","rep_url","this","mmsid","callNumber","repId","repUrl","App","useState","loading","setLoading","searchCollectionText","setSearchCollectionText","bibs","setBibs","globalError","setGlobalError","errorMessage","setErrorMessage","success","setSuccess","totalBibNumberInCollection","setTotalBibNumberInCollection","setPercentProgress","MAX_PAGE_SIZE","ExportToExcel","fn","dl","log","sort","b","nameA","toUpperCase","nameB","elt","DOMParser","parseFromString","htmlStrStart","i","getHtmlString","getElementById","wb","XLSX","table_to_book","sheet","raw","bookType","bookSST","params","getCallNumberField","data","fields","getElementsByTagName","getAttribute","childNodes","innerHTML","undefined","ApiDataService","total_record_count","bib","bibDataTotalResults","dataArr","map","bib_item","index","parseInt","functions","push","Promise","all","bibsResponse","bibResponse","bibMarcXmlData","anies","setCallNumber","replace","repResponse","representation","delivery_url","setRepId","setRepUrl","useEffect","downloadDocx","Container","fluid","Alert","onClose","src","alt","margin","marginLeft","paddingTop","Row","text","Spinner","animation","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document"],"mappings":"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","file":"static/js/main.57041eb3.chunk.js","sourcesContent":["import React from 'react';\r\nimport { Form, InputGroup, Button, ListGroup } from 'react-bootstrap';\r\nimport './InputBox.css'\r\n\r\n\r\nfunction InputBox({ icon, placeholder, inputText, inputTextChange, onEnter, onClear }) {\r\n    return (\r\n        <div className=\"c-input-box\">\r\n            <Form.Group controlId=\"formInputBox\">\r\n                <InputGroup>\r\n                    <InputGroup.Prepend>\r\n                        <Button variant=\"link\" onClick={() => onClear()}><i className=\"bi bi-x-lg\" style={{ color: 'red', fontSize: '2rem' }}></i></Button>\r\n                    </InputGroup.Prepend>\r\n                    {/* <Button variant=\"dark\" onClick={() => onClear()}><i className=\"bi bi-x\" style={{ color: 'red' }}></i></Button> */}\r\n                    <Form.Control type=\"text\" placeholder={placeholder}\r\n                        value={inputText} onChange={e => inputTextChange(e.target.value)} onKeyPress={e => e.key === 'Enter' && e.target.value.length > 0 ? onEnter(e.target.value) : null}\r\n                    />\r\n                    {/* <button type=\"button\" class=\"btn bg-transparent\" style=\"margin-left: -40px; z-index: 100;\">\r\n                        <i class=\"bi bi-x\"></i>\r\n                    </button> */}\r\n                    <InputGroup.Append>\r\n                        <Button variant=\"link\" onClick={e => onEnter(e.target.value)}><i className=\"bi bi-filetype-xlsx\" style={{ color: 'black', fontSize: '2rem' }}></i></Button>\r\n                        {/* <Button variant=\"outline-secondary\" onClick={e => onEnter(e.target.value)}><i className=\"bi bi-filetype-xlsx\" style={{ color: 'gray', fontSize: '2rem' }}></i></Button> */}\r\n                    </InputGroup.Append>\r\n                </InputGroup>\r\n            </Form.Group>\r\n        </div>\r\n        //     <div class=\"input-group\">\r\n        //     <input type=\"text\" class=\"form-control\" placeholder=\"Search...\">\r\n        //     <button type=\"button\" class=\"btn bg-transparent\" style=\"margin-left: -40px; z-index: 100;\">\r\n        //       <i class=\"fa fa-times\"></i>\r\n        //     </button>\r\n        // </div>\r\n\r\n    );\r\n}\r\n\r\nexport default InputBox;","import axios from \"axios\";\r\n\r\nconst SERVER_URL = \"https://cors-proxy-alma.herokuapp.com/almaws/v1/bibs/\";\r\n//const SERVER_URL = \"https://api-eu.hosted.exlibrisgroup.com/almaws/v1/bibs/collections/\";\r\nconst SERVER_URL_AFTER_ID_COLLECTION = \"/bibs?\";//offset=0&limit=100\";\r\nconst SERVER_URL_AFTER_ID_BIB = \"?view=full&expand=None\";\r\n//const API_KEY = \"&apikey=l8xx3380e09cbbc2490cbaee30eb37bc1376\";\r\n//\"https://api-eu.hosted.exlibrisgroup.com/almaws/v1/bibs/collections/$collectionID/bibs?offset=$offset&limit=100&apikey=l8xx3380e09cbbc2490cbaee30eb37bc1376\";\r\n//\"https://api-eu.hosted.exlibrisgroup.com/almaws/v1/bibs/$MMSID?view=full&expand=None&apikey=l8xx3380e09cbbc2490cbaee30eb37bc1376\";\r\n///almaws/v1/bibs/{mms_id}/representations\r\n\r\nconst types = {\r\n    COLLECTIONS: \"collections/\",\r\n    REPRESENTATIONS: \"/representations\",\r\n    NONE: \"\"\r\n}\r\n\r\nasync function getDataById(type, id, pageNum, pageSize) {\r\n    const getURL = type==types.COLLECTIONS ? \r\n    SERVER_URL + type + id + SERVER_URL_AFTER_ID_COLLECTION + \"offset=\" + pageNum + \"&limit=\" + pageSize :\r\n    type==types.REPRESENTATIONS ?\r\n    SERVER_URL + id + type :\r\n    SERVER_URL + id + SERVER_URL_AFTER_ID_BIB;\r\n    try {\r\n        const res = await axios.get(getURL);\r\n        return({response: res, error: null});\r\n    } catch (err) {\r\n        console.error(\"Error while geting collection with id= \" + id, err);\r\n        return({response: null, error: err});\r\n    }\r\n}\r\n\r\nexport default { getDataById, types }","export default class BibModel {\r\n    constructor(mms_id, title, call_number, totalBibs, rep_id, rep_url) {\r\n        this.mmsid = mms_id;\r\n        this.title = title;\r\n        this.callNumber = call_number;\r\n        this.totalBibs = totalBibs;\r\n        this.repId = rep_id;\r\n        this.repUrl = rep_url;\r\n    }\r\n\r\n    setCallNumber(call_number) {\r\n        this.callNumber = call_number;\r\n    }\r\n\r\n    setTotalBibs(totalBibs) {\r\n        this.totalBibs = totalBibs; \r\n    }\r\n\r\n    setRepId(rep_id) {\r\n        this.repId = rep_id;\r\n    }\r\n\r\n    setRepUrl(rep_url) {\r\n        this.repUrl = rep_url;\r\n    }\r\n}","import './App.css';\nimport { Container, Spinner, Alert, Row } from \"react-bootstrap\";\nimport InputBox from \"./components/InputBox/InputBox\";\nimport { useEffect, useState } from 'react';\nimport ApiDataService from './utils/ApiDataService';\nimport BibModel from './model/BibModel';\n// import ProgressComponent from './components/ProgressComponent/ProgressComponent'\n// import BibCard from \"./components/BibCard/BibCard\"\n// import HTMLtoDOCX from 'html-to-docx';\n// import { saveAs } from 'file-saver';\nimport * as XLSX from 'xlsx';\n//import { marc } from \"marc4js\"; \n\n\nfunction App() {\n  const [loading, setLoading] = useState(false);\n  const [searchCollectionText, setSearchCollectionText] = useState(\"\");\n  const [bibs, setBibs] = useState([]);\n  const [globalError, setGlobalError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(\"אירעה שגיאה\");\n  const [success, setSuccess] = useState(false);\n  const [totalBibNumberInCollection, setTotalBibNumberInCollection] = useState(0);\n  const [percentProgress, setPercentProgress] = useState(0);\n  const MAX_PAGE_SIZE = 100;//0-100\n  const TAG = \"098\";\n\n  //const bibCards = bibs !== undefined ? bibs.map((bib, index) => <BibCard key={index.toString()} bib={bib} index={index}></BibCard>) : [];\n\n  useEffect(() => {\n    if (bibs.length > 0 && bibs.length == totalBibNumberInCollection) {\n      downloadDocx();\n    }\n  }, [bibs])\n\n  function clear() {\n    console.log(\"clear pressed!!!\");\n    setTotalBibNumberInCollection(0);\n    setSearchCollectionText(\"\");\n    setBibs([]);\n    setErrorMessage(\"\");\n    setGlobalError(false);\n    setSuccess(false);\n  }\n  //{book.mmsid && <Card.Link href={\"https://haifa-primo.hosted.exlibrisgroup.com/primo-explore/search?query=any,contains,\" + book.mmsid + \"&tab=haifa_all&vid=HAU&lang=iw_IL\"} target=\"_blank\"><Card.Text>הספר בקטלוג אוניברסיטת חיפה </Card.Text></Card.Link>}\n  //<a href=\"url\">link text</a>\n\n  function sortBibs() {\n    bibs.sort(function (a, b) {\n      debugger\n      const nameA = a.callNumber.toUpperCase(); // ignore upper and lowercase\n      const nameB = b.callNumber.toUpperCase(); // ignore upper and lowercase\n      if (nameA < nameB) {\n        return -1;\n      }\n      if (nameA > nameB) {\n        return 1;\n      }\n\n      // names must be equal\n      return 0;\n    });\n  }\n\n  function getHtmlString() {\n    let htmlStrStart = `html dir=\"rtl\" lang=\"he-IL\" class=\"no-js no-svg\">\n    <head>\n        <meta charset=\"UTF-8\" />\n    </head>\n    <body>\n        <table id=\"tbl_exporttable_to_xls\">\n            <th>MMS ID</th>\n            <th>כותר</th>\n            <th>מספר מיון</th>\n            <th>קישור</th>\n            <th>כותר מתוקן</th>\n            <th>הערות</th>\n            <tbody>`\n    for (let i = 0; i < bibs.length; i++) {\n      htmlStrStart += '<tr><td>' + bibs[i].mmsid + '</td><td>' + bibs[i].title + '</td><td>' + bibs[i].callNumber + '</td><td>' + '<a href=' + bibs[i].repUrl + '>' + bibs[i].repId + '</a>' + '</td><td>' + \"\" + '</td><td>' + \"\" + '</td></tr>'\n      // htmlStrStart += '<tr><td>' + bibs[i].mmsid + '</td><td>' + bibs[i].title + '</td><td>' + bibs[i].callNumber + '</td><td>' + '<a href=' + \"https://haifa-primo.hosted.exlibrisgroup.com/primo-explore/search?query=any,contains,\" + bibs[i].repId + \"&tab=haifa_all&vid=HAU&lang=iw_IL target=_blank\" + '>' + bibs[i].mmsid + '</a>' + '</td><td>' + \"\" + '</td><td>' + \"\" + '</td></tr>'\n      // htmlStrStart += '<tr><td>' + bibs[i].mmsid + '</td><td>' + flipBracketsDirection(bibs[i].title) + '</td><td>' + bibs[i].callNumber + '</td></tr>'\n    }\n    htmlStrStart +=\n      `</tbody>\n            </table>\n        </body>\n    </html>`\n    debugger\n    return htmlStrStart;\n  }\n\n  function ExportToExcel(type, fn, dl) {\n    console.log(\"This should happen only once!!!\");\n    sortBibs();\n    var doc = new DOMParser().parseFromString(getHtmlString(), \"text/html\");\n    var elt = doc.getElementById('tbl_exporttable_to_xls');\n    var wb = XLSX.utils.table_to_book(elt, { sheet: \"sheet1\", raw: true });\n    setPercentProgress(100);\n    return dl ?\n      XLSX.write(wb, { bookType: type, bookSST: true, type: 'base64' }) :\n      XLSX.writeFile(wb, fn || (searchCollectionText + '.' + (type || 'xlsx')));\n  }\n\n  async function downloadDocx(params) {\n    // console.log(\"downloadDocx\");\n    // console.log(getHtmlString());\n    //await HTMLtoDOCX(htmlString, headerHTMLString, documentOptions, footerHTMLString)\n    // const fileBuffer = await HTMLtoDOCX(getHtmlString(), null, {\n    //   table: { row: { cantSplit: true } },\n    //   orientation: \"landscape\",\n    //   title: \"Adi's test\",\n    //   footer: true,\n    //   pageNumber: true,\n    // });\n\n    ExportToExcel('xlsx');\n    setSuccess(true);\n    // saveAs(fileBuffer, 'html-to-docx.docx');\n  }\n\n  function getCallNumberField(data) {\n    var parser = new DOMParser();\n    var xmlDoc = parser.parseFromString(data, \"text/xml\");\n    let callNumber;\n    const fields = xmlDoc.getElementsByTagName(\"datafield\");\n    for (let i = 0; i < fields.length; i++) {\n      if (TAG == fields[i].getAttribute('tag')) {\n        callNumber = fields[i].childNodes[0] ? fields[i].childNodes[0].innerHTML : undefined;\n        break;\n      }\n    }\n    return callNumber;\n  }\n\n  async function handleInputEnter(pageNum) {\n    setBibs([]);\n    setTotalBibNumberInCollection(0);\n\n\n    setLoading(true);\n    const response = await ApiDataService.getDataById(ApiDataService.types.COLLECTIONS, searchCollectionText, 0, MAX_PAGE_SIZE);\n    setLoading(false);\n    if (response.error) {\n      setGlobalError(true);\n      //setErrorMessage(response.error);\n    }\n    else {\n      if (response.response) {\n        if (response.response.data.total_record_count > 0) {\n          setPercentProgress(10);\n          const data = response.response.data.bib;\n          let bibDataTotalResults = [];\n          //setBibs(data.map((bib_item) => new BibModel(bib_item.mms_id, bib_item.title)));\n          //setBibs(bibs => bibs.concat(data.map((bib_item) => new BibModel(bib_item.mms_id, bib_item.title))));\n          //const bibsDataResult = data.map((bib_item) => new BibModel(bib_item.mms_id, bib_item.title));\n          const dataArr = data.map((bib_item) => new BibModel(bib_item.mms_id, bib_item.title));\n          bibDataTotalResults = [...bibDataTotalResults, ...dataArr]; //Here it is the result of all bibs in the first page\n          setTotalBibNumberInCollection(response.response.data.total_record_count);\n          if (response.response.data.bib.length < response.response.data.total_record_count) {//If there are more pages\n            let index = response.response.data.total_record_count % 100 == 0 ? parseInt(response.response.data.total_record_count / 100) : parseInt(response.response.data.total_record_count / 100) + 1;\n            const functions = []; //Array of all the pages num\n            for (let i = 1; i < index; ++i) {\n              functions.push(i * 100);\n            }\n            // const promise1 = Promise.resolve(3);\n            // const promise2 = 42;\n            // const promise3 = new Promise(function (resolve, reject) {\n            //   setTimeout(resolve, 100, 'foo');\n            // });\n\n            // Promise.all([promise1, promise2, promise3]).then(function (values) {\n            //   console.log(values);\n            // });\n            // expected output: Array [3, 42, \"foo\"]\n            // let promise = new Promise(function(resolve, reject) {\n            //   resolve(\"done\");\n\n            //   reject(new Error(\"…\")); // ignored\n            //   setTimeout(() => resolve(\"…\")); // ignored\n            // });\n            // const promises = [];\n            // for (let i = 0; i < index; ++i) {\n            //   const promise = new Promise(function (resolve, reject) {\n            //     setLoading(true);\n            //     const response = ApiDataService.getDataById(ApiDataService.types.COLLECTIONS, searchCollectionText, i, MAX_PAGE_SIZE);\n            //     debugger\n            //     setLoading(false);\n            //     if (response.error) {\n            //       setGlobalError(true);\n            //       reject(response.error);\n            //     }\n            //     else {\n            //       if (response.response) {\n            //         debugger\n            //         const data = response.response.data.bib;\n            //         const bibsDataResult = data.map((bib_item) => new BibModel(bib_item.mms_id, bib_item.title));\n            //         debugger\n            //         resolve(bibsDataResult);\n            //       };\n            //     }\n            //   })\n            //   promises.push(promise);\n            // }\n            // Promise.all(promises).then(values => {\n            //   debugger\n            //   console.log(\"The valus are: \" + values);\n            //   bibDataTotalResults = values;\n            // });\n            setLoading(true);\n            //Here we call to get all the bibs from pages >= 100\n            await Promise.all(\n              functions.map(async (index) => {\n                const bibsResponse = await ApiDataService.getDataById(ApiDataService.types.COLLECTIONS, searchCollectionText, index, MAX_PAGE_SIZE)\n                if (bibsResponse.error) {\n                  setGlobalError(true);\n                  //setErrorMessage(bibsResponse.error);\n                }\n                else {\n                  if (bibsResponse.response) {\n                    const data = bibsResponse.response.data.bib;\n                    const dataArr = data.map((bib_item) => new BibModel(bib_item.mms_id, bib_item.title));\n                    bibDataTotalResults = [...bibDataTotalResults, ...dataArr];\n                    setPercentProgress(30);\n                    setLoading(false);\n                  }\n                }\n              })\n            )\n          }\n\n          setLoading(true);\n          //Here we call to get data for every bib by its id\n          await Promise.all(\n            bibDataTotalResults.map(async (bib) => {\n              const bibResponse = await ApiDataService.getDataById(ApiDataService.types.NONE, bib.mmsid);\n              if (bibResponse.error) {\n                setGlobalError(true);\n                //setErrorMessage(bibResponse.error);\n              }\n              else {\n                if (bibResponse.response) {\n                  const bibMarcXmlData = bibResponse.response.data.anies[0];\n                  let callNumber = getCallNumberField(bibMarcXmlData);\n                  bib.setCallNumber(callNumber.replace(/ /g, ''));\n                  setPercentProgress(60);\n                }\n              }\n            })\n          )\n          //Here we call to get the representation of every bib by the id\n          await Promise.all(\n            bibDataTotalResults.map(async (bib) => {\n              const repResponse = await ApiDataService.getDataById(ApiDataService.types.REPRESENTATIONS, bib.mmsid);\n              if (repResponse.error) {\n                setGlobalError(true);\n                //setErrorMessage(repResponse.error);\n              }\n              else {\n                if (repResponse.response) {\n                  if (repResponse.response.data.total_record_count > 0) {\n                    const repId = repResponse.response.data.representation[0] ? repResponse.response.data.representation[0].id : undefined;\n                    //const repId = repResponse.response.data.representation[0].thumbnail_url;\n                    const repUrl = repResponse.response.data.representation[0].delivery_url;\n                    if (!repId) {\n                      console.log(\"undefine!!!!\");\n                    }\n                    bib.setRepId(repId);\n                    bib.setRepUrl(repUrl);\n                  }\n                  else {\n                    bib.setRepId(\"אין תמונה\");\n                    bib.setRepUrl(\"\");\n                  }\n                  setPercentProgress(90);\n                }\n              }\n            })\n          )\n          setBibs(bibDataTotalResults);\n          setLoading(false);\n        }\n        else {\n          setGlobalError(true);\n          setErrorMessage(\"אין רשומות באוסף זה\");\n        }\n        // setLoading(true);\n        // //if (bibs.length == response.response.data.total_record_count) {\n        // bibsDataResult.forEach(bib => {\n        //   const bibResponse = ApiDataService.getDataById(ApiDataService.types.NONE, bib.mmsid);\n        //   if (bibResponse.error) {\n        //     setGlobalError(true);\n        //   }\n        //   else {\n        //     if (bibResponse.response) {\n        //       debugger\n        //       const bibMarcXmlData = bibResponse.response.data.anies;\n        //       getCallNumberField(bibMarcXmlData);\n        //     }\n        //   }\n        // });\n        // await Promise.all();\n        // setLoading(false);\n        // //}\n\n        //setBibs(data.map((plainBib) => new BibModel(plainBib)));\n        //setTotalPages(0);\n      }\n    }\n  }\n\n  return (\n    <div className=\"App\">\n      <Container fluid>\n        <div>\n          {globalError && <Alert variant=\"danger\" onClose={() => setGlobalError(false)}>\n            {errorMessage}\n          </Alert>}\n          {success && <Alert variant=\"success\" onClose={() => setSuccess(false)}>\n            הקובץ מוכן להורדה\n          </Alert>}\n        </div>\n        <img src=\"https://haifa-primo.hosted.exlibrisgroup.com/primo-explore/custom/HAU/img/library-logo.png\" alt=\"ספריית יונס וסוראיה נזריאן\" />\n        <div style={{ margin: \"20px\" }}>\n          <h2>רשומות ביבליוגרפיות לפי מספר אוסף</h2>\n          <h4 style={{ marginLeft: 'auto !important', paddingTop: '30px' }}>:(collectionID יש להזין) הורדת קובץ אקסל של רשומות ביבליוגרפיות וקישורים לאובייקטים הדיגיטליים שבהן, על פי מספר אוסף בעלמא</h4>\n        </div>\n        <Row id=\"rowForInput\">\n          <InputBox\n            icon={<i className=\"bi bi-collection-fill\"></i>}\n            placeholder=\"כאן יש להכניס מספר אוסף (Collection ID) לחיפוש ...\"\n            onEnter={handleInputEnter}\n            inputText={searchCollectionText}\n            inputTextChange={(text) => setSearchCollectionText(text)}\n            onClear={clear}\n          />\n        </Row>\n        <div className=\"p-bib-cards\">\n          {loading && <div className=\"p-subject-spinner\"><Spinner animation=\"border\" variant=\"primary\" /></div>}\n          {/* {loading && <ProgressComponent\n            percentProgress={percentProgress}\n            success={false} \n            warning={false} \n            error={false}\n          />} */}\n        </div>\n      </Container>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport 'bootstrap-icons/font/bootstrap-icons.css';\nimport 'semantic-ui-css/semantic.min.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}